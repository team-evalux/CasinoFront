<!-- src/app/app.component.html -->
<div class="app-shell">
  <app-header></app-header>

  <main class="app-main">
    <router-outlet></router-outlet>
  </main>
  <app-chat></app-chat>

  <app-footer></app-footer>
</div>

<!-- Drawer global -->
<div class="app-drawer" *ngIf="ui.menuOpen()">
  <div class="app-drawer__backdrop" (click)="ui.closeMenu()"></div>

  <aside class="app-drawer__panel" (click)="$event.stopPropagation()">
    <button class="drawer-close" (click)="ui.closeMenu()" aria-label="Fermer">×</button>

    <!-- Connecté -->
    <ng-container *ngIf="isLoggedIn(); else loginForm">
      <!-- entête utilisateur -->
      <div style="display:flex;align-items:center;gap:12px;margin-bottom:10px;">
        <div style="width:42px;height:42px;border-radius:50%;
                    display:flex;align-items:center;justify-content:center;
                    background:#0f1519;border:1px solid rgba(255,255,255,.12);font-weight:700;">
          {{ (user()?.pseudo || user()?.email || 'U').slice(0,1) }}
        </div>
        <div>
          <div style="font-size:12px;color:#9fb0bd">Connecté</div>
          <div style="font-weight:700;">{{ user()?.pseudo || user()?.email }}</div>
        </div>
      </div>

      <!-- solde -->
      <div style="margin:8px 0 16px;">
        <app-balance-header></app-balance-header>
      </div>

      <!-- navigation : boutons pleine largeur -->
      <nav style="display:flex;flex-direction:column;gap:10px;margin:6px 0 14px;">
        <a class="bouton" style="width:100%;text-align:center;"
           routerLink="/home" (click)="ui.closeMenu()">Accueil</a>
        <a class="bouton" style="width:100%;text-align:center;"
           routerLink="/history" (click)="ui.closeMenu()">Historique</a>
        <a class="bouton" style="width:100%;text-align:center;"
           routerLink="/about" (click)="ui.closeMenu()">À propos</a>
        <a class="bouton" style="width:100%;text-align:center;"
           routerLink="/support" (click)="ui.closeMenu()">Support</a>
      </nav>

      <!-- déconnexion -->
      <button class="bouton bouton--danger" style="width:100%;" (click)="logout()">
        Se déconnecter
      </button>
    </ng-container>

    <!-- Non connecté : on garde ton composant de login -->
    <ng-template #loginForm>
      <app-login></app-login>
    </ng-template>
  </aside>
</div>

