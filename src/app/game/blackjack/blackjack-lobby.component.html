<div class="conteneur section-jeu">
  <div class="panneau">
    <h2 class="titre-page">Tables Blackjack</h2>

    <div class="coin-stage" style="position:relative;">
      <!-- üîí Overlay du cadenas (m√™me style que coinflip) -->
      <div *ngIf="!isLoggedIn" class="lock-overlay">
      <div class="lock">üîí</div>
      <div>Connecte-toi pour acc√©der aux tables</div>
        <a routerLink="/login" class="cta">Se connecter</a>

  </div>

  <header class="lobby-head">
    <div class="create-form">
      <input [(ngModel)]="create.name" maxlength="10" placeholder="Nom de la table (optionnel)">
      <label>Si√®ges
        <input type="number" [(ngModel)]="create.maxSeats" min="2" max="7" maxlength="1">
      </label>
      <label>Min
        <input type="number"
               [(ngModel)]="create.minBet"
               min="100"
               max="1000000"
               placeholder="Min 100"
               (change)="validateBets()"
               style="width:90px;">
      </label>

      <label>Max
        <input type="number"
               [(ngModel)]="create.maxBet"
               min="1000"
               max="1000000"
               placeholder="Max 1 000 000"
               (change)="validateBets()"
               style="width:110px;">
      </label>

      <select [(ngModel)]="create.visibility">
        <option value="PUBLIC">Publique</option>
        <option value="PRIVATE">Priv√©e</option>
      </select>
      <input *ngIf="create.visibility==='PRIVATE'"
             [(ngModel)]="create.code"
             placeholder="Code d‚Äôacc√®s (optionnel)" maxlength="10">
      <button (click)="onCreate()" [disabled]="loading || !isLoggedIn">Cr√©er</button>
    </div>
  </header>

  </div>

  <a [routerLink]="['/home']" class="bouton">Retour</a>

  <div *ngIf="loading">Chargement‚Ä¶</div>
  <div *ngIf="error" class="err">{{ error }}</div>

  <section class="grid">
    <article *ngFor="let t of tables" class="card">
      <h3>{{ t.name ? t.name : ('Table ' + (t.id + '').slice(0,6)) }}</h3>
      <p>
        <small>
          {{ t.maxSeats }} si√®ges
          ‚Ä¢ Phase: {{ t.phase }}
          ‚Ä¢ {{ t.isPrivate ? 'Priv√©e' : 'Publique' }}
          <span *ngIf="t.minBet || t.maxBet"> ‚Ä¢ Mise: {{ t.minBet || 0 }} - {{ t.maxBet || '‚àû' }}</span>
        </small>
      </p>
      <div style="display:flex; gap:8px;">
        <button (click)="goTable(t)" [disabled]="!isLoggedIn">Rejoindre</button>
        <button *ngIf="t.creatorEmail === (JSON.parse(localStorage.getItem('user')||'{}')?.email || null)"
                (click)="closeTableFromLobby(t.id)"
                [disabled]="t.phase !== 'BETTING'"
                [title]="t.phase !== 'BETTING'
                ? '‚è≥ Attends la fin de la manche pour fermer la table'
                : 'Fermer la table'">
          ‚ùå Fermer
        </button>
      </div>
    </article>
  </section>
</div>
</div>
